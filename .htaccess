# do not touch without a clue about apache2 rewriterules.
# read the manual; https://httpd.apache.org/docs/current/mod/mod_rewrite.html
ServerSignature Off
Options +FollowSymLinks

<IfModule mod_rewrite.c>
    # initialization of the apache2 rewrite engine;
    RewriteEngine on
    RewriteBase /
    # redirect www.nicer.app to nicer.app
    RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
    RewriteRule ^(.*)$ https://%1/$1 [R=307,L]

    # /*--Heart of the blogging features--*/
    RewriteCond %{REQUEST_METHOD} ^(GET)$
    RewriteCond %{HTTP:X-Requested-With} XMLHttpRequest
    RewriteRule ^(.*)/in/(.*)$ NicerAppWebOS/logic.AJAX/ajax_get_content.php?username=$1&url1=in&dataID=$2 [L]

    RewriteCond %{REQUEST_METHOD} ^(GET)$
    RewriteRule ^(.*)/in/(.*)$ NicerAppWebOS/index.php?username=$1&url1=in&dataID=$2 [L]


    RewriteCond %{REQUEST_METHOD} ^(GET)$
    RewriteCond %{HTTP:X-Requested-With} XMLHttpRequest
    RewriteRule ^(.*)/on/(.*)$ NicerAppWebOS/logic.AJAX/ajax_get_content.php?username=$1&url1=on&dataID=$2 [L]

    RewriteCond %{REQUEST_METHOD} ^(GET)$
    RewriteRule ^(.*)/on/(.*)$ NicerAppWebOS/index.php?username=$1&url1=on&dataID=$2 [L]


    RewriteCond %{REQUEST_METHOD} ^(GET)$
    RewriteCond %{HTTP:X-Requested-With} XMLHttpRequest
    RewriteRule ^(.*)/during/(.*)$ NicerAppWebOS/logic.AJAX/ajax_get_content.php?username=$1&url1=during&dataID=$2 [L]

    RewriteCond %{REQUEST_METHOD} ^(GET)$
    RewriteRule ^(.*)/during/(.*)$ NicerAppWebOS/index.php?username=$1&url1=during&dataID=$2 [L]


    # /*--Front page--*/
    # front page's data when requested with (javascript) $.ajax aka na.loadContent()
            # tried this already (doesn't work)
            ##RewriteCond %{REQUEST_FILENAME} !-f
            ##RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_METHOD} ^(GET)$
    RewriteCond %{HTTP:X-Requested-With} XMLHttpRequest
    RewriteRule ^$ NicerAppWebOS/logic.AJAX/ajax_get_content.php?viewID=/ [L]

    # front page when it needs the full NicerApp framework
            # tried this already (doesn't work)
            ##RewriteCond %{REQUEST_FILENAME} !-f
            ##RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_METHOD} ^(GET)$
    RewriteRule ^$ NicerAppWebOS/index.php?viewID=/ [L]

    RewriteCond %{REQUEST_METHOD} ^(GET)$
    RewriteRule ^nc$ NicerAppWebOS/index.php?uvt=n&lc=n&viewID=/ [L]

    # /*--all other pages--*/

    # all other pages' data that got requested with (javascript) $.ajax aka na.loadContent()
            # tried this already (doesn't work)
            ##RewriteCond %{REQUEST_FILENAME} !-f
            ##RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} !^/NicerAppWebOS/apps/NicerAppWCS/applications/2D/musicPlayer/music/.*$
    RewriteCond %{HTTP:X-Requested-With} XMLHttpRequest
    RewriteRule ^view-content/(.*)$ NicerAppWebOS/logic.AJAX/ajax_get_content.php?seoValue=$1&%{QUERY_STRING} [L]

    # all pages that got requested via a bookmark or as links elsewhere on the web
    # (requiring the full NicerApp WebOS HTML, CSS and JS to be sent along with the content)
            # tried this already (doesn't work)
            ##RewriteCond %{REQUEST_FILENAME} !-f
            ##RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} !^/NicerAppWebOS/apps/NicerAppWCS/applications/2D/musicPlayer/music/.*$
    RewriteRule ^view/(.*)$ NicerAppWebOS/index.php?seoValue=$1&%{QUERY_STRING} [L]


    RewriteCond %{REQUEST_URI} !^/NicerAppWebOS/apps/NicerAppWCS/applications/2D/musicPlayer/music/.*$
    RewriteCond %{HTTP:X-Requested-With} XMLHttpRequest
    RewriteRule ^([\-\w\d]+)$ NicerAppWebOS/logic.AJAX/ajax_get_content.php?seoValue=$1 [L]

    RewriteCond %{REQUEST_URI} !^/NicerAppWebOS/apps/NicerAppWCS/applications/2D/musicPlayer/music/.*$
    RewriteRule ^([\-\w\d]+)$ NicerAppWebOS/index.php?seoValue=$1 [L]
</IfModule>





<ifModule mod_gzip.c>
mod_gzip_on Yes
mod_gzip_dechunk Yes
mod_gzip_item_include file .(html?|txt|css|js|json|php|pl)$
mod_gzip_item_include handler ^cgi-script$
mod_gzip_item_include mime ^text/.*
mod_gzip_item_include mime ^application/x-javascript.*
mod_gzip_item_exclude mime ^image/.*
mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
</ifModule>
<IfModule mod_filter.c>
    AddOutputFilterByType DEFLATE "application/atom+xml" \
                                  "application/javascript" \
                                  "application/json" \
                                  "application/ld+json" \
                                  "application/manifest+json" \
                                  "application/rdf+xml" \
                                  "application/rss+xml" \
                                  "application/schema+json" \
                                  "application/vnd.geo+json" \
                                  "application/vnd.ms-fontobject" \
                                  "application/x-font-ttf" \
                                  "application/x-javascript" \
                                  "application/x-web-app-manifest+json" \
                                  "application/xhtml+xml" \
                                  "application/xml" \
                                  "font/eot" \
                                  "font/opentype" \
                                  "image/bmp" \
                                  "image/svg+xml" \
                                  "image/vnd.microsoft.icon" \
                                  "image/x-icon" \
                                  "text/cache-manifest" \
                                  "text/css" \
                                  "text/html" \
                                  "text/javascript" \
                                  "text/plain" \
                                  "text/vcard" \
                                  "text/vnd.rim.location.xloc" \
                                  "text/vtt" \
                                  "text/x-component" \
                                  "text/x-cross-domain-policy" \
                                  "text/xml"

</IfModule>


